<html><head><title>Using ProteoCombiner to integrate bottom-up and top-down proteomics data to improve proteoform identification</title></head><body><h1>Using ProteoCombiner to integrate bottom-up and top-down proteomics data to improve proteoform identification</h1>Authors: Diogo Borges Lima, Mathieu Dupré, Magalie Duchateau, Quentin Giai Gianetto, Martial Rey, Mariette Matondo, Julia Chamot-Rooke<br>Abstract: <p>Here we present a high-performance software for proteome analysis that combines different mass spectrometric approaches, such as, top-down for intact protein analyses and bottom-up, for proteolytic fragment characterization. <strong>ProteoCombiner</strong> capitalizes on the data arising from different experiments and proteomics search engines and presents the results in a user-friendly manner. Our tool also provides a rapid and easy visualization, manual validation and comparison of the identified proteoform sequences, including post-translational modifications (PTM) characterization. Thus, ProteoCombiner is recommended for studies dealing with different proteomics strategies, in order to increase confidence in proteoform identification including PTMs.</p><br>Keywords: proteomics, bioinformatics, top-down, bottom-up, mass spectrometry<br><h2>Introduction</h2><p>Proteoforms describe all combinatorial sources of variation from a single gene, including genetic variations, alternative splicing, and post-translational modifications [<a href="https://science.sciencemag.org/content/359/6380/1106" target="_blank">1</a>]. Proteoform analysis is nowadays of crucial importance since they have been proven to have a key role in biological systems [<a href="https://onlinelibrary.wiley.com/doi/full/10.1002/pmic.201300432" target="_blank">2</a>] [<a href="https://science.sciencemag.org/content/331/6018/778" target="_blank">3</a>]. This includes both precise determination of the expressed sequence of the protein and the characterization of all Post Translational Modifications (PTM), in particular their precise localization and determination of their combination (combinatorial PTM). Several proteomics strategies, including bottom-up, middle-down and top-down proteomics, have been developed to analyze the PTM at the peptide level or to directly target proteoforms. Nevertheless, there is a lack of bioinformatics tools able to combine such proteomics results and it is still difficult to map the PTMs identified in bottom-up data onto proteoforms obtained by top-down proteomics.</p><p>In this protocol, we describe the key steps for using <strong>ProteoCombiner</strong>, a powerful tool capable of integrating proteomics datasets obtained from different experiments (bottom-up and top-down proteomics) and different search engines, such as, PatternLab for Proteomics[<a href="https://www.nature.com/articles/nprot.2015.133" target="_blank">4</a>], MaxQuant[<a href="https://pubs.acs.org/doi/abs/10.1021/pr101065j" target="_blank">5</a>], Comet[<a href="https://onlinelibrary.wiley.com/doi/full/10.1002/pmic.201200439" target="_blank">6</a>], ProsightPD[<a href="https://currentprotocols.onlinelibrary.wiley.com/doi/full/10.1002/0471250953.bi1306s19" target="_blank">7</a>], pTop[<a href="https://pubs.acs.org/doi/10.1021/acs.analchem.5b03963" target="_blank">8</a>] and TopPIC[<a href="https://academic.oup.com/bioinformatics/article/32/22/3495/2525589" target="_blank">9</a>], in order to increase the confidence of proteoform identification and facilitate the characterization of PTMs. A video demonstrating ProteoCombiner v1.0 in action is available at <a href="https://proteocombiner.pasteur.fr/video" target="_blank">https://proteocombiner.pasteur.fr/video</a>.</p><h2>Equipment</h2><p><strong>Hardware</strong></p><p><strong>•&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>&nbsp;A computer with at least 8 GB RAM and 2 computing cores is recommended.</p><p><br></p><p><strong>Software</strong></p><p><strong>•&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>Windows 10 (32 or 64 bits) or later.</p><p>•&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The .NET framework 4.7, which will be automatically updated by ProteoCombiner if necessary.</p><p>•&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>ProteoCombiner</strong> software is available at <a href="https://proteocombiner.pasteur.fr" target="_blank">https://proteocombiner.pasteur.fr</a>.</p><p><br></p><p><strong>Data files</strong></p><p><strong>•&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProteoCombiner</strong> v1.0 is compatible with output data files from PatternLab for Proteomics[<a href="https://www.nature.com/articles/nprot.2015.133" target="_blank">4</a>], MaxQuant[<a href="https://pubs.acs.org/doi/abs/10.1021/pr101065j" target="_blank">5</a>], Comet[<a href="https://onlinelibrary.wiley.com/doi/full/10.1002/pmic.201200439" target="_blank">6</a>], ProsightPD[<a href="https://currentprotocols.onlinelibrary.wiley.com/doi/full/10.1002/0471250953.bi1306s19" target="_blank">7</a>], pTop[<a href="https://pubs.acs.org/doi/10.1021/acs.analchem.5b03963" target="_blank">8</a>] and TopPIC[<a href="https://academic.oup.com/bioinformatics/article/32/22/3495/2525589" target="_blank">9</a>] and can work directly with Thermo®, ABSciex®, Agilent® and Waters® RAW files. The software is also compatible with mzML 1.1.0, MS2 and Mascot Generic Format (MGF).</p><p>•&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>ProteoCombiner</strong> saves results in its own format (<em>i.e.</em>, <em>*.pcmb</em>) and exports them as Excel® <em>(*.xlsx</em>) and PDF® format files.</p><h2>Procedure</h2><p><strong>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software installation:</strong></p><p>Download <strong>ProteoCombiner</strong> by clicking on the <em>Download</em> button at <a href="https://proteocombiner.pasteur.fr" rel="noopener noreferrer" target="_blank">https://proteocombiner.pasteur.fr</a>.</p><p><br></p><p><strong>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Workflow</strong></p><p>The following workflow demonstrates how to combine proteomics data using <strong>ProteoCombiner</strong>.</p><p><br></p><p><strong>2.1.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Execute the <em>ProteoCombiner</em> tool (<strong>Figure 1</strong>)</p><p><br></p><p><strong>[Figure 1]</strong></p><p><strong>2.2.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specify the directory containing all result files from bottom-up proteomics experiments. In this directory can also have the database used in the search and the original RAW files in one of these formats: mzML 1.1.0, MS2, Mascot Generic Format (MGF), ABSciex®, Agilent®, Waters® and Thermo® RAW.</p><p><br></p><p><strong>2.2.1.</strong> <strong><em>Bottom-up proteomics</em></strong></p><p><strong>2.2.1.1.</strong> For PatternLab for Proteomics and Comet output files, we recommend to use SEPro[<a href="https://www.nature.com/articles/nprot.2015.133" rel="noopener noreferrer" target="_blank">1</a>] tool for filtering results, and use the <em>*.sepr</em> file(s) as input of ProteoCombiner.</p><p><strong>2.2.1.2.</strong> For MaxQuant output files, we recommend using the <em>txt folder</em>, that contains the following required files: proteinGroups.txt, peptides.txt and msms.txt.</p><p><br></p><p><strong>2.2.2.</strong> <strong><em>Database</em></strong></p><p><strong>2.2.2.1.</strong> We recommend using the FASTA and/or XML database formats obtained from <a href="https://www.uniprot.org/" rel="noopener noreferrer" target="_blank">Uniprot</a>.</p><p><strong>2.3.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specify the directory containing all result files from top-down proteomics experiments. In this directory can also have the database used in the search and the original RAW files in one of these formats: mzML 1.1.0, MS2, Mascot Generic Format (MGF), ABSciex®, Agilent®, Waters® and Thermo® RAW.</p><p><br></p><p><strong>2.3.1.</strong> <strong><em>Top-Down proteomics</em></strong></p><p><strong>2.3.1.1.</strong> For ProsightPD results, we recommend exporting only PSM identifications, which contain all information of each proteoform (*<em>_PSM.txt</em>). This corresponding file must have the following columns: Checked, Confidence, Identifying Node Type, Identifying Node, Search ID, Identifying Node No, PSM Ambiguity, Sequence, Annotated Sequence, Modifications, # Protein Groups, # Proteins, Master Protein Accessions, Protein Accessions, Protein Descriptions, # Missed Cleavages, Charge, Original Precursor Charge, DeltaScore, DeltaCn, Rank, Search Engine Rank, m/z [Da], MH+ [Da], Theo. MH+ [Da], DeltaM [ppm], Deltam/z [Da], Matched Ions, Total Ions, Intensity, Activation Type, MS Order, Isolation Interference [%], Ion Inject Time [ms], RT [min], First Scan, Last Scan, Master Scan(s), Spectrum File, Ions Matched, Annotation, -Log P-Score, -Log E-Score, C Score, Corrected Delta Mass (Da), Corrected Delta Mass (ppm).</p><p><strong>2.3.1.2.</strong> For pTop output files, we recommend using only the file(s) ending with <em>_filter.csv</em>.</p><p><strong>2.3.1.3.</strong> For TopPIC output files, we recommend using only the file(s) ending with <em>_prsm.csv</em>.</p><p><br></p><p><strong>2.3.2.</strong> <strong><em>Database</em></strong></p><p><strong>2.3.2.1.</strong> We recommend using the FASTA and/or XML database formats obtained from <a href="https://www.uniprot.org/" rel="noopener noreferrer" target="_blank">Uniprot</a>.</p><p><br></p><p><strong>2.4.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The <em>Parameters</em> tab allows to access various parameters that are not usually required to be changed for combining all data.</p><p><strong>2.4.1.</strong>&nbsp;&nbsp;&nbsp;<em>Remove Contaminants</em>: This option allows to remove all protein sequences that represent a contaminant.</p><p><strong>2.4.2.</strong> <em>Remove Reverse Sequence</em>: This option allows to remove all decoy protein sequences.</p><p><br></p><p><strong>2.5.</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To start combining data, click on the <em>OK</em> button in the <em>Combine</em> tab.</p><p><em>PS: Although ProteoCombiner capitalizes on the data arising from different proteomics search engines, we recommend using a single software-tool to analyze all experiments for proteolytic fragment characterization, and another to analyze intact proteins experiments.</em></p><p><br></p><p><strong>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exploring the results</strong></p><p>Note: At this point we recommend saving results by selecting <em>Save</em> from File menu or by pressing CTRL + S.</p><p><br></p><p><strong>3.1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>Filter</em></strong></p><p><strong>3.1.1.</strong>&nbsp;&nbsp;&nbsp;All results are pre-filtered according to the following parameters designated on the top of the <em>Results Browser </em>window, as shown in <strong>Figure 2</strong>:</p><p><strong>3.1.1.1.</strong> <em>CombScore</em>: Results containing identification scores greater than or equal to this value will be displayed.</p><p><strong>3.1.1.2.</strong> <em>Peptide Count</em>: Only identified proteins containing at least this value as identified peptide amount (by bottom-up) will be displayed.</p><p><strong>3.1.1.3.</strong> <em>Spectral Count</em>: Only identified proteins containing at least this value as identified spectra amount will be displayed.</p><p><strong>3.1.1.4.</strong> <em>Unique peptide</em>: Only identified proteins containing at least this value as identified unique peptide amount will be displayed.</p><p><strong>3.1.1.5.</strong> <em>Search</em>: Only results from peptides or proteins containing the sequence input to this field will be displayed. The user can further search by ProteinID (protein accession number), protein description or file name.</p><p><strong>3.1.1.6.</strong> By clicking on <em>Filter</em> button, this operation is accomplished using all of the parameters described above.</p><p><strong>3.1.1.7.</strong> By clicking on <em>Reset</em> button, all initial values are restored.</p><p><br></p><p><strong>[Figure 2]</strong></p><p><br></p><p><strong>3.2.</strong> <strong><em>Combined results</em></strong></p><p>All identified proteins that contain a valid sequence* will be displayed on this tab sorted by <em>Score</em> followed by <em>Sequence Coverage</em>. The protein score is represented by the best proteoform score.</p><p><em>*Protein sequence present in the database.</em></p><p><strong>3.2.1.</strong> By clicking on an identified protein, all respective identified proteoforms will be displayed* below the protein table sorted by <em>CombScore**</em>.</p><p><em>*If there is no identified proteoform for a respective protein, all possible identified peptides will be displayed instead.</em></p><p><em>**CombScore is calculated by summing two different scores: i) a score related to the TDP identification software (which is normalized between 0 and 1; and ii) the percentage of the proteoform sequence coverage based on the peptides, obtained in BUP approach, that match to this proteoform. This score also ranges between 0 and 1.</em></p><p><strong>3.2.1.1.</strong> The user can assess each identified proteoform by clicking on the <em>Is valid</em> checkbox.</p><p><strong>3.2.1.1.1. </strong>At this point, we recommend saving results once again so that the personal assessments can be included.&nbsp;This is done by selecting <em>Save</em> from <em>File</em> menu or by pressing CTRL + S.</p><p><strong>3.2.1.2.</strong> By clicking on an identified proteoform, all respective identified peptides will be displayed below the proteoform table sorted by <em>Peptide Score</em>.</p><p><strong>3.2.1.2.1</strong> By double-clicking on an identified peptide, the tandem mass spectrum, which contains the best identification score, will be displayed on <em>Spectrum Viewer</em>. (<strong>Figure 3</strong>)</p><p><br></p><p><strong>[Figure 3]</strong></p><p><br></p><p><strong>3.2.2.</strong> By double-clicking on an identified protein, a new window will be opened that shows the <em>Protein Coverage</em> (<strong>section 3.5</strong>).</p><p><br></p><p><strong>3.3.</strong> <strong><em>Bottom-up proteomics results</em></strong></p><p>All identified proteins and the corresponding peptides will be displayed on this tab.</p><p><strong>3.3.1.</strong> By clicking on an identified protein, all respective identified peptides will be displayed below the protein table.</p><p><strong>3.3.1.1.</strong> By clicking on an identified peptide, all respective identified tandem mass spectra will be displayed below the peptide table.</p><p><strong>3.3.1.1.1.</strong> By double-clicking on an identified tandem mass spectrum, the <em>Spectrum Viewer</em> will be opened. (<strong>Figure 3</strong>)</p><p><strong>3.3.2.</strong> By double-clicking on an identified protein, a new window will be opened that shows the <em>Protein Coverage</em> (<strong>section 3.5</strong>).</p><p><br></p><p><strong>3.4.<em> Top-down proteomics results</em></strong></p><p>All identified proteoforms will be displayed on this tab grouped by <em>Theoretical Mass</em> in Da.</p><p><strong>3.4.1.</strong> By double-clicking on the <em>Scan Number</em> column of an identified proteoform, the <em>Spectrum Viewer</em> will be opened. (<strong>Figure 3</strong>). By clicking on any other column, a new window will be opened that shows the <em>Protein Coverage</em> (<strong>section 3.5</strong>).</p><p><br></p><p><strong>3.5.</strong> <strong><em>Protein Coverag</em>e</strong></p><p><strong>3.5.1.</strong> Once the window is opened, the information will be displayed on the top tab: Protein description, Monoisotopic and Average protein mass* and Sequence coverage. (<strong>Figure 4</strong>)</p><p><em>*If Protein coverage window is opened from the click of a specific proteoform, its monoisotopic and average mass will be displayed instead of the protein mass.</em></p><p><strong>[Figure 4]</strong></p><p><br></p><p><strong>3.5.2.</strong> The left box will display all approaches used to identify the proteoforms and/or peptides. By clicking on each item, all respective lines will be high-lighted in the right box.</p><p><strong>3.5.2.1.</strong> Bottom-up and middle-down approaches, represented by the blue color,</p><p><strong>3.5.2.2.</strong> Top-down approach is represented in three different colors: Expected proteoforms in orange, which means all identified proteoforms by the full theoretical mass; non-expected proteoforms in cyan, which represents all identified truncated proteoforms; and tagged proteoforms in red, which means all proteoforms that were identified by a part of the protein sequence.</p><p><strong>3.5.2.3.</strong> All identified PTMs will also be displayed in this box.</p><p><strong>3.5.3.</strong> The right box will display all identified proteoforms and/or peptides that will be represented by different lines. All of them will be displayed sorted by <em>CombScore</em>. On the top will be displayed the full protein sequence and all theoretical modifications (present in the database) as can be seen in <strong>Figure 4</strong>. All theoretical chains will be shown below protein sequence in gray dash lines. The user is able to check all information about the modification or theoretical chain by passing the mouse over the line or the modified amino acid. (<strong>Figure 4</strong>)</p><p><strong>3.5.3.1.</strong> Each proteoform will be displayed according to the classification: expected, non-expected or tagged proteoform. By right-clicking on each line, the user is able to assess the proteoform identification (valid or invalid); in addition, it’s possible to highlight only the peptides that fit into the proteoform. (<strong>Figure 5</strong>). By hovering over each line, some information will be shown: Proteoform sequence, Score, Search engine that identified this specific sequence, Start and End positions.</p><p><strong>3.5.3.2.</strong> All identified PTMs will also be displayed and by hovering over each one, it is possible to check their position and description.</p><p><strong>[Figure 5]</strong></p><p><br></p><p><strong>3.5.3.3.</strong> The identified proteoforms and/or peptides can be displayed in a single line or in multiple lines. The user can change the way to visualize in <em>Utils</em> menu, by selecting <em>Custom Protein Visualization</em> option in <em>Results Browser</em> window (or by pressing ALT + C).</p><p><br></p><p><strong>3.6.<em> Loading results</em></strong></p><p><strong>3.6.1. <em>ProteoCombiner</em></strong> loads results in its own format (<em>*.pcmb</em>). This can be accomplished in three ways, the easiest one is by double-clicking on a ProteoCombiner results file. If the <em>Results Browser</em> window is opened, another way to launch the file is by clicking on <em>Load </em>option from the <em>File</em> menu or by pressing CTRL + O, as seen in (<strong>Figure 6</strong>).&nbsp;Otherwise, if the main window is opened, select <em>Load Results</em> from <em>File</em> menu (or press CTRL + O), as seen in <strong>Figure 7</strong>.</p><p><strong>[Figure 6]</strong></p><p><strong>[Figure 7]</strong></p><p><br></p><p><strong>3.7.</strong> <strong><em>Exporting results</em></strong></p><p><strong>3.7.1.</strong> <strong><em>ProteoCombiner</em></strong> also allows to export all combined results to Excel® (<em>*.xlsx</em>) or PDF® file. This is done by selecting <em>Excel file</em> from the File menu Þ Export results (or by pressing ALT + E). Or by selecting <em>PDF file</em> from the File menu Þ Export results (or by pressing ALT + P). (<strong>Figure 6</strong>)</p><h2>References</h2><p>[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L. M. Smith and N. L. Kelleher, “Proteoforms as the next proteomics currency,” <em>Science</em>, vol. 359, no. 6380, pp. 1106–1107, Mar. 2018.</p><p>[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Z. R. Gregorich and Y. Ge, “Top-down proteomics in health and disease: Challenges and opportunities,” <em>PROTEOMICS</em>, vol. 14, no. 10, pp. 1195–1210, 2014.</p><p>[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J. Chamot-Rooke <em>et al.</em>, “Posttranslational Modification of Pili upon Cell Contact Triggers N. meningitidis Dissemination,” <em>Science</em>, vol. 331, no. 6018, pp. 778–782, Feb. 2011.</p><p>[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P. C. Carvalho <em>et al.</em>, “Integrated analysis of shotgun proteomic data with PatternLab for proteomics 4.0,” <em>Nat. Protoc.</em>, vol. 11, no. 1, pp. 102–117, Dec. 2015.</p><p>[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J. Cox, N. Neuhauser, A. Michalski, R. A. Scheltema, J. V. Olsen, and M. Mann, “Andromeda: A Peptide Search Engine Integrated into the MaxQuant Environment,” <em>J. Proteome Res.</em>, vol. 10, no. 4, pp. 1794–1805, Apr. 2011.</p><p>[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J. K. Eng, T. A. Jahan, and M. R. Hoopmann, “Comet: an open-source MS/MS sequence database search tool,” <em>Proteomics</em>, vol. 13, no. 1, pp. 22–24, Jan. 2013.</p><p>[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;“ProSightPD 1.1: Integrating Top Down Searching in Proteome Discoverer 2.1.” .</p><p>[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R.-X. Sun <em>et al.</em>, “pTop 1.0: A High-Accuracy and High-Efficiency Search Engine for Intact Protein Identification,” <em>Anal. Chem.</em>, vol. 88, no. 6, pp. 3082–3090, Mar. 2016.</p><p>[9]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q. Kou, L. Xun, and X. Liu, “TopPIC: a software tool for top-down mass spectrometry-based proteoform identification and characterization,” <em>Bioinforma. Oxf. Engl.</em>, vol. 32, no. 22, pp. 3495–3497, Nov. 2016.</p><h2>Acknowledgements</h2><p>The authors thank the Agence Nationale de la Recherche (project ANR-15-CE18-0021) for financial support. This work is also part of the European Joint Programme One Health EJP from the European Union’s Horizon 2020 research and innovation programme (Grant Agreement 773830).</p><p><br></p></body></html>