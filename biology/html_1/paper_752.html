<html><head><title>User Manual for Tomography-Guided 3D Reconstruction of Subcellular Structures (TYGRESS)</title></head><body><h1>User Manual for Tomography-Guided 3D Reconstruction of Subcellular Structures (TYGRESS)</h1>Authors: Zhiguo Shang, Kangkang Song, Xiaofeng Fu, Xiaochu Lou, Nikolaus Grigorieff, Daniela Nicastro<br>Abstract: <p>Recent advances in cryo-electron microscopy (cryo-EM) are paving the way to determining isolated three-dimensional (3D) macromolecular structures at near-atomic resolution using single-particle cryo-electron microscopy (SP-cryo-EM). However, determining the subcellular structures in intact cells and organelles<em> </em>using cryo-electron tomography (cryo-ET) and subtomogram averaging, another cryo-EM technique, with comparable resolution remains a challenge. Current methodologies can only reach a resolution of several nanometers in most samples studied. Here, we introduce a new hybrid method, called Tomography-Guided 3D Reconstruction of Subcellular Structures (TYGRESS) that is able to achieve structural determination of subcellular structures within their natural crowded environment with nanometer-resolution by combining the advantages of cryo-ET and SP-cryo-EM.&nbsp;</p><br>Keywords: cryo-electron microscopy , cryo-electron tomography <br><h2>Introduction</h2><p>SP-cryo-EM and cryo-ET both generate three-dimensional (3D) reconstructions of native biological macromolecules under cryogenic conditions. However, whereas SP-cryo-EM can be used to determine the structure of isolated macromolecules with up to atomic resolution (~3Å), the resolution achieved by cryo-ET of intact cells or organelles paired with subtomogram averaging lags approximately one order of magnitude behind (~30Å). Here, we introduce a hybrid-method called “<u>T</u>omograph<u>Y</u>-<u>G</u>uided 3D&nbsp;<u>RE</u>construction of&nbsp;<u>S</u>ubcellular&nbsp;<u>S</u>tructures” (TYGRESS), which combines the advantages of both SP-cryo-EM (images with good signal-to-noise ratio/contrast and minimal radiation damage of the sample) and cryo-ET averaging (extraction and 3D alignment of macromolecules contained in a complex cellular sample). Ultimately TYGRESS is a SP-reconstruction, but the parameters from subtomogram averaging are critical to guide particle picking and image alignment – steps that usually prohibit SP-cryo-EM of complex cellular samples. </p><p><br></p><p>In this method, a typical high dose (HD) single particle cryo-EM micrograph is acquired (i.e., with an electron dose that is higher than for individual tile series images) immediately prior to a conventional low dose (LD) cryo-ET tilt series. The LD cryo-ET data set are processed, including subtomogram averaging of the particle of interest. The parameters, i.e., the particle position and alignment, are then used to guide the particle picking in the HD single-particle cryo-EM data set and initialize its angular alignment. With this information from cryo-ET, single particle image processing techniques can be applied to subcellular samples, despite the superposition of many structures in the SP projection image.</p><h2>Equipment</h2><p><strong>Hardware requirements and software installation</strong></p><p>A computer cluster and/or workstation with GPU with shared storage is recommended for running TYGRESS. Before installation of TYGRESS, please ensure the software packages below are installed by following the installation guide of each package. You can also find the hardware and operating system requirements in the distribution pages of the following software packages. </p><p><br></p><p><strong>MATLAB</strong>: The major running environment for TYGRESS.&nbsp;Use the R2014b version of MATLAB for the best results. </p><p><strong>IMOD</strong> &amp; <strong>PEET</strong>: Tilt series alignment, tomogram generation, and subtomogram averaging. (http://bio3d.colorado.edu/imod/ &amp; http://bio3d.colorado.edu/PEET/) </p><p><strong>CTFFIND3</strong>: Detect defocus value (http://grigoriefflab.janelia.org/ctf)</p><p><strong>EMAN2</strong>: ‘Normalization’ function (<a href="https://blake.bcm.edu/emanwiki/EMAN2" target="_blank">https://blake.bcm.edu/emanwiki/EMAN2</a>)</p><p><strong>FREALIGN</strong>: 3D reconstruction (<a href="http://grigoriefflab.janelia.org/frealign" target="_blank">http://grigoriefflab.janelia.org/frealign</a>)</p><p><strong>Bfactor</strong>: Apply B-factor for the final reconstruction (<a href="http://grigoriefflab.janelia.org/grigorieff/download_b.html" target="_blank">http://grigoriefflab.janelia.org/grigorieff/download_b.html</a>)</p><h2>Procedure</h2><p><strong>1: Preparation to run TYGRESS</strong></p><p><br></p><p>1.1 To use TYGRESS on the example data set, download and unzip the TYGRESS source code and example data set package (www.tygress.org), and then follow Procedure step 2 (“Preparation of TYGRESS input files” below).</p><p><strong>Note：</strong>TYGRESS is also available on Code Ocean as a compute capsule (https://doi.org/10.24433/CO.2034333.v1). Please read the readme file on the Code Ocean TYGRESS page for more details.</p><p><br></p><p>1.2 To use your own data set, please finish the data collection, tomogram reconstruction, and subtomogram averaging before following Procedure 2, below.</p><p><br></p><p>1.2.1 <strong>Data collection</strong>. During data collection, two data sets need to be acquired for each region of interest. (1) First, acquire a 2D image at 0 degree using an electron dose typical for conventional SP-cryo-EM (HD image), which is used for final TYGRESS reconstruction; (2), immediately after collecting the HD image, collect a traditional low-dose tilt series (LD images) of the same region, which is used for retrieving the position information for each particle of interest after tomogram reconstruction and subtomogram averaging. Note: to minimize the effects of radiation damage in the final reconstruction, the HD image must be recorded prior to the LD images.</p><p><br></p><p>1.2.2 <strong>Motion correction</strong>. If movie stacks were taken during the data collection, run the whole-frame motion correction using IMOD scripts.</p><p><br></p><p>1.2.3 <strong>Alignment of the combined tilt series</strong>. Each HD image needs to be inserted into its corresponding tilt series at the angle where the HD image was taken using the “newstack” command in the IMOD package, resulting in a “combined tilt series”. For example, an HD image recorded at 0 degrees should be inserted just before the LD image at 0 degrees. After tilt series alignment using the IMOD package, the combined HD and LD images ensure a common reference frame for the later steps in the TYGRESS procedure.</p><p><br></p><p>1.2.4 <strong>Tomogram reconstruction</strong>. After alignment, only the LD images are used to generate the tomogram using the IMOD package.</p><p><br></p><p>1.2.5 <strong>Subtomogram averaging</strong>. The subtomogram averaging can be performed using the PEET package in IMOD. Run PEET averaging for each tilt series and all of the particles of interest, respectively.</p><p>&nbsp;</p><p><strong>2: Preparation TYGRESS input files.</strong></p><p><br></p><p>2.1 Prepare two TYGRESS input text files.</p><p><br></p><p>2.1.1 There is one file named as “TYGRESS_input.txt” in the TYRESS source code folder (as shown below in the example data set), which contains all the parameters to run TYGRESS, such as the work directory, file path, 3D reconstruction parameters, <em>etc</em>. Update these parameters as needed to reflect the location and organization of your files. If you are following along with the example dataset, modify the following:</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fnDataDir= (copy the full path name for the example data folder that you downloaded from this tutorial)</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fncode= (copy the full path name for the TYGRESS source code folder that you downloaded from this tutorial)</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fnref= (copy the full path name for the .mrc file within the example folder)</p><p><br></p><p><br></p><p><br></p><p><br></p><p>Example of a “TYGRESS_input.txt” file</p><p>=========================================================================</p><p>Part I Parameters for running TYGRESS</p><p>fnDataDir = /project/cellbiology/Nicastro_lab/nusr/shang/linux/Tygress/example/&nbsp;&nbsp;&nbsp;&nbsp;% project data directory</p><p>fncode = /home2/s165838/Tygress/Tcoden/Tcode/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% TYGRESS code directory</p><p>fnWorkDir = combined_PEET/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% combined peet directory</p><p>fnDef = ctffind/DefocusList.txt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% defocus file</p><p>fnref = /home2/s165838/Tygress/ref.mrc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% reference masked after PEET average</p><p>fnCombinedHD = HD_particles/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% high dose 2D particle directory</p><p>&nbsp;fnmod = combined_mod_csv/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% combined mod &amp; csv directory</p><p>&nbsp;fncsv = Iter1_particles/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% updated peet run for whole dataset</p><p>&nbsp;csvDirname = Itr1/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% csv directory</p><p>&nbsp;csvname_h = _Itr1_MOTL_Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% csv root name after PEET of individual tilt series</p><p>csvname_t = _Iter5.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% csv tail name after PEET of individual tilt series</p><p>modname_h = A1.mod.FOIE.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% mod root name after PEET of individual tilt series</p><p>modname_t = .txt.mod.txt.Ax_Pred_.txt.mod&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% mod tail name after PEET of individual tilt series</p><p>fnPEETRoot = example&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% root name for PEET running</p><p>particleSize = 180&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% particle size for PEET running</p><p>fnDist = N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% file for correct distortion (gif camera), 'N' for no correction</p><p>tail_st = _fused.st&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% entire tilt date set</p><p>tail_hd = _HD.st&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% file name use for save HD micrograph</p><p>amplitude_contrast = 0.14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% thin ice sample use 0.07 and thick ice use 0.14</p><p>axoRepeat =180&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% pixel size for particle (used for remove edged particles) in high dose micrograph</p><p>Mag1 = 22500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% micrograph magnification</p><p>PickSize = 300&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% size for pick 2D high dose particle</p><p>sizex = 200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% size for final out put structure</p><p>root_csv = _MOTL_Tom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% csv root name after run entire PEET</p><p>tail_csv = _Iter2.csv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% csv tail name after run entire PEET</p><p>SizeRef = 180&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% size of reference volume</p><p>sx = 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% shift range of coordinates, nm</p><p>sa = 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% shift range of orientation, degree</p><p>parallel_f = 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% set 1 for run job in parallel job</p><p>Ncpu = 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% cup number for parallel job</p><p>tail_rec = _fused_exHD.rec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% tail part of rec file</p><p>pixel_size = 5.562&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% angstrom per pixel for raw particle</p><p>kV = 300&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% voltage</p><p>Cs = 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% value of spherical aberration coefficient of objective in mm</p><p>use_ctf = 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% set 1 for ctf correction</p><p>out_mrc = 96nm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% output reconstruction file</p><p>imageSize = 2048&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% entire raw image size K*K</p><p>sizescale = 0.6&nbsp;&nbsp;&nbsp;</p><p>n_neighbor = 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% number of neighbored particles which used for background reference</p><p>dis_neighbor = 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;% distance (# pixels) used for selecting nearby particles for background reference</p><p><br></p><p><br></p><p>Part II Parameter file for reconstruction, visit FREALIGN webpage for more details</p><p>data_input&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;96nm</p><p>raw_images1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;96nm</p><p>thresh_reconst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;90.0</p><p>thresh_refine&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;90.0</p><p>pixel_size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.562</p><p>dstep_frealign&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13</p><p>WGH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.14</p><p>kV1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;300.0</p><p>Cs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0</p><p>RI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0</p><p>RO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000.0</p><p>PBC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0</p><p>BOFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;75.0</p><p>ASYM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</p><p>DANG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</p><p>ITMAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</p><p>MODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</p><p>XSTD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0</p><p>RBFACT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</p><p>FPART&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F</p><p>FMAG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F</p><p>FDEF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F</p><p>FASTIG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F</p><p>IEWALD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</p><p>dfsig&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;100</p><p>FBEAUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F</p><p>FCREF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F</p><p>res_reconstruction&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0</p><p>res_low_refinement&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;800.0</p><p>res_refinement&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0</p><p>start_process&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</p><p>end_process&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</p><p>first_particle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</p><p>last_particle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;471</p><p>increment&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</p><p>=========================================================================</p><p><br></p><p><strong>Note：</strong>When modifying the “TYGRESS_input.txt” file, please use the full path name to the directories for 'fnDataDir', 'fncode', and 'fnref', and only use the relative file folder names for the other parameters when needed.</p><p><br></p><p>2.1.2 The file named “DataList.txt” in the TYGRESS source code folder (as shown below in the example data set) has three columns containing the “data set main name” + “data set sub name” + “total .mod number”, which you should change as needed.</p><p><br></p><p>Example of a “DataList.txt” file</p><p>=========================================================================</p><p>WT_20120914&nbsp;S1&nbsp;9</p><p>WT_20120914&nbsp;S2&nbsp;9</p><p>WT_20120914&nbsp;S3&nbsp;9</p><p>WT_20120914&nbsp;S4&nbsp;9</p><p>WT_20120914&nbsp;S5&nbsp;9</p><p>=========================================================================</p><p><br></p><p>2.2 Modify the “ctffind.csh” file in the TYGRESS source code folder, which will be used to determine CTF. Please see the example in the “ctffind.csh” file for details. You may at least need to change the path of the “ctffind3.exe” file. For more details about how to modify this file, please visit (http://grigoriefflab.janelia.org/sites/default/files/readme_ctf.txt).</p><p><br></p><p>2.3 Modify the path of your FREALIGN installation in the “mreconstruct_noMask.com” file. Please see the example “mreconstruct_noMask.com” file for details.</p><p><br></p><p><strong>3: Run TYGRESS</strong></p><p>Open the Matlab interface, and set the TYGRESS source code folder as the work path. Then, in Matlab, open the TYGRESS_GUI (Figure 1). Click the “Tygress parameter file” button, input the “TYGRESS_input.txt” file, click the “Data list” button, and input the “DataList.txt” file. Click “Yes” on the corresponding step to have TYGRESS run that step (Figure 1). All steps should be run in order if it is your first time processing your TYGRESS data. (Note: You can process the steps one by one, or you can run all selected steps together.)</p><p><br></p><p>Final 3D reconstruction is performed with FREALIGN, and all output is saved under the “Reconstruction” folder. For more information about FREALIGN, please visit (http://grigoriefflab.janelia.org/frealign).</p><p><br></p><p><strong>4: Directory tree of TYGRESS (Figure 2)</strong></p><p><br></p><p>Please note:</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.mod(1) and .csv(1) are the parameters after running PEET for individual tilt series</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.mod(2) and .csv(2) are the parameters for running PEET for the entire data, and .csv(3) is the output</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.csv(3) and mod(2) are used for TYGRESS alignment and to generate the .par file</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.mrc(1) is the 2D particle data set and .mrc(2) is the final output for the 3D structure</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.txt(1) is the parameter for defocus and .txt(2) coordinates parameters of each particle</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.m is the code for running TYGRESS</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><u>Project data</u></strong> folder contains all tilt series data; each tilt series is processed (alignment and reconstruction in IMOD) in its own particles folder, including particles_Predict and Iter folders (alignment results from individual PEET runs).</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><u>Combined_PEET</u></strong> folder includes combined alignment for all 3D subtomogram particles in PEET (Iter1_particles); Combined_mod_csv contains the file for running PEET for the entire dataset; 2D HD particles are picked in each data set under the HD_particles folder. The defocus detection for HD images is put in the ctffind folder.</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><u>TYGRESS code</u></strong> folder stores all codes needed for running TYGRESS. The ‘m’extension&nbsp;indicates matlab scripts, which can be only executed in Matlab. The structure is output as a .mrc file.</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><u>Reconstruction</u></strong> folder stores all output results after reconstruction with FREALIGN.</p><h2>Time Taken</h2><p>In the example data set, which includes five tilt series, each tilt series includes all the files generated after tomogram reconstruction and subtomogram averaging. The PEET averaging for the whole dataset is also included. Therefore, you can run TYGRESS directly after changing the work directories in the “TYGRESS_input.txt” file. The total TYGRESS processing time from CTF finding to final reconstruction will take less than 30 minutes on a common computer cluster. &nbsp;</p><h2>Anticipated Results</h2><p>5.1&nbsp;*.mod(1) and *.csv(1) are the output files after running PEET for each individual tilt series.</p><p><br></p><p>5.2 You can copy the *.mod(1) and *.csv(1) to the Combined_mod_csv folder as *.mod(2) and *.csv(2) to run the PEET for the whole datasets, and then you will get *.csv(3) after PEET. All these .mod and .csv files are obtained before you starting to run TYGRESS.</p><p><br></p><p>5.3 After you run <strong>Step 1</strong> in the TYGRESS GUI, the “ctffind” folder will be created and the defocus information will be saved in the *.txt(1) file. Moreover, the “HD_particle” folder will be created and all HD images will be saved in its sub_folder.</p><p><br></p><p>5.4 After you run <strong>Step 2</strong> in the TYGRESS GUI, the program will use the information from *.mod(2) and *.csv(3) to pick particles from the HD images,&nbsp;and then save all picked 2D particles as *.mrc file and save the coordinate parameters of each picked particle as *.txt(2) file, and alignment parameters as *.par file.</p><p><br></p><p>5.5 After you run <strong>Step 3</strong> in the TYGRESS GUI, the program will align the 2D particles picked and update the *.par file. <strong>Note:</strong> for further constrained alignment, you need to update your 'sx' (for x, y shift) and 'sa' (for angular shift) values in the “TYGRESS_input.txt” file, use the *.par file created in <strong>Step 3</strong> to replace the *.par file generated in <strong>Step 2,</strong> and re-run <strong>Step 3</strong>.</p><p><br></p><p>5.6 After you run <strong>Step 4</strong> in the TYGRESS GUI, the program will generate the 3D reconstruction and save the *.mrc(2) file.</p><h2>References</h2><p>This protocol is related to the following article:</p><p>Song, K., Shang, Z., Fu, X., Lou, X., Grigorieff, N., and Nicastro, D. (2018). Structure of the ciliary axoneme at nanometer resolution reconstructed by TYGRESS. <em>BioRxiv</em> 363317.</p></body></html>