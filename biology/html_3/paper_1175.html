<article>
<section>
<h1 id="header">Backward simulation for inferring hidden biomolecular kinetic profiles</h1>
<p><time datetime="2021-11-19">Published: November 19, 2021</time></p>
<p>Junghun Chae,<sup><a href="#aff1">1</a>,<a href="#fn1">7</a>,<a href="#fn2">8</a></sup> Roktaek Lim,<sup><a href="#aff2">2</a>,<a href="#fn1">7</a></sup> Cheol-Min Ghim,<sup><a href="#aff1">1</a>,<a href="#aff3">3</a>,<a href="#cor1">*</a></sup> and Pan-Jun Kim<sup><a href="#aff2">2</a>,<a href="#aff4">4</a>,<a href="#aff5">5</a>,<a href="#aff6">6</a>,<a href="#fn3">9</a>,<a href="#cor2">**</a></sup></p>
<p id="aff1"><sup>1</sup>Department of Physics, Ulsan National Institute of Science and Technology, Ulsan 44919, Republic of Korea</p>
<p id="aff2"><sup>2</sup>Department of Biology, Hong Kong Baptist University, Kowloon, Hong Kong</p>
<p id="aff3"><sup>3</sup>Department of Biomedical Engineering, Ulsan National Institute of Science and Technology, Ulsan 44919, Republic of Korea</p>
<p id="aff4"><sup>4</sup>Center for Quantitative Systems Biology &amp; Institute of Computational and Theoretical Studies, Hong Kong Baptist University, Kowloon, Hong Kong</p>
<p id="aff5"><sup>5</sup>State Key Laboratory of Environmental and Biological Analysis, Hong Kong Baptist University, Kowloon, Hong Kong</p>
<p id="aff6"><sup>6</sup>Abdus Salam International Centre for Theoretical Physics, 34151 Trieste, Italy</p>
<p id="fn1"><sup>7</sup>These authors contributed equally</p>
<p id="fn2"><sup>8</sup>Technical contact</p>
<p id="fn3"><sup>9</sup>Lead contact</p>
<p id="cor1"><sup>*</sup>Correspondence: <a href="mailto:cmghim@unist.ac.kr">cmghim@unist.ac.kr</a></p>
<p id="cor2"><sup>**</sup>Correspondence: <a href="mailto:panjunkim@hkbu.edu.hk">panjunkim@hkbu.edu.hk</a></p>
<p><span class="open-access">Open Access</span> • DOI: <a href="https://doi.org/10.1016/j.xpro.2021.100958">10.1016/j.xpro.2021.100958</a></p>
</section>
<section>
<h2 id="summary">Summary</h2>
<p>Our backward simulation (BS) is an approach to infer the dynamics of individual components in ordinary differential equation (ODE) models, given the information on relatively downstream components or their sums. Here, we demonstrate the use of BS to infer protein synthesis rates with a given profile of protein concentrations over time in a circadian system. This protocol can also be applied to a wide range of problems with undetermined dynamics at the upstream levels.</p>
<p>For complete details on the use and execution of this protocol, please refer to <a class="external-link" href="http://refhub.elsevier.com/S2666-1667(21)00664-X/sref1">Lim et al. (2021)</a>.</p>




<div class="highlights">
<h3>Highlights</h3>
<ul>
<li>Inference of upstream dynamics with information on the downstream profile</li>
<li>Applies to infer protein synthesis rates with a given circadian protein profile</li>
<li>Widely applicable to systems biology models with known downstream profiles</li>
</ul>
</div>
<div class="graphical-abstract">
<h3>Graphical abstract</h3>
<figure><img src="https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1175-GA.jpg" alt="GraphicalAbstract.jpg"></figure>
</div></section>
<section>
<h2 id="before-you-begin">Before you begin</h2>
<h3 id="sec1.1">Check whether the backward simulation (BS) is desirable</h3>
<div class="timing">
<span class="timing-title">Timing:</span> 10 min</div>
<p>We have developed the backward simulation (BS) method to discover the “internal” dynamics of the system described by ordinary differential equations (ODEs) with pre-selected model structure and parameter values<i>.</i> When the temporal profiles of relatively downstream components or their sums (but not the profiles of upstream components) are known, BS retrieves the upstream profiles that exactly reproduce the known downstream profiles, through the straightforward ODE calculation with the relevant downstream variables. On the other hand, an existing practice is to assume the plausible forms of these unknown upstream profiles with additional free parameters, and then estimate these parameters to best fit the observed downstream profiles. However, in contrast to the BS, the latter method incurs the computational costs for that parameter estimation and may not even necessarily reproduce the correct downstream profiles.</p>
<p>As a prototype application of this method, we here elaborate the case of the circadian protein degradation model in <a href="#bib1">Lim et al. (2021)</a>. Specifically, in contrast to a common practice of simulating the time-course profile of a circadian protein concentration by its upstream elements such as the rhythmic synthesis rate of the protein over time, we intended to maintain the total protein concentration profile at the downstream side as it was and simulate the corresponding rate of the protein synthesis and other upstream kinetic processes in given parameter conditions (<a href="#bib1">Lim et al., 2021</a>). There were three main reasons for this simulation: (<i>i</i>) unlike the mRNA profile, the potentially time-of-day-specific translation rate per mRNA is not commonly known and hence it is difficult to determine the profile of the protein synthesis rate directly from the existing experimental data. In contrast, the experimental profile of the total protein levels is readily available for the incorporation to model simulations. In <a href="#bib1">Lim et al., 2021</a>, given the experimental protein profiles, we performed the BS over randomly-sampled parameter values, and identified the parameter sets for simulation results in quantitative agreement with the empirically observed, rhythmic degradation rates of the proteins. (<i>ii</i>) Another reason was that we wanted to dissect the underpinning mechanism of the rhythmic degradation rate of a circadian protein by <i>rigorously controlling for the effect of the protein profile</i> over a range of parameter values, while avoiding the confounding effect from the changes in the protein profile itself caused by the conventional simulation with given profiles of upstream elements (“forward simulation”). (<i>iii</i>) Lastly, we considered an evolutionary viewpoint that the protein profile can be of a more fundamental position than an mRNA or translation-rate profile so that the protein synthesis rate may have adapted to the protein profile—the protein profile is more likely to influence a biological phenotype than other elements in the system such as mRNA profile. Overall, we foresee a variety of applications of the BS, including the cases with data unavailability at upstream sides, the mechanistic studies with strictly-controlled downstream profiles, and the evolutionary modeling with fixed downstream profiles.</p>
<h3 id="sec1.2">Install python and python packages</h3>
<div class="timing">
<span class="timing-title">Timing:</span> 10 min</div>
<ol>
<li>Download Python 3.7.4 or a higher version from <a href="https://www.python.org">https://www.python.org</a>. The Python version can be checked by the following command:</li>
</ol>
<div class="textbox">
<p><code>&gt; python3 –version</code></p>
</div>
<ol start="2">
<li>To solve ODE models, the scipy python module is needed. Install scipy package:</li>
</ol>
<div class="textbox">
<p><code>&gt; pip install scipy</code></p>
</div>
</section>
<section>
<h2 id="key-resources-table">Key resources table</h2>
<table id="krt">
<thead>
<tr>
<th>REAGENT or RESOURCE</th>
<th>SOURCE</th>
<th>IDENTIFIER</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="3">Software and algorithms</td>
</tr>
<tr>
<td>Custom codes for model simulation</td>
<td>This paper</td>
<td><a href="https://git.io/JuAFt">https://git.io/JuAFt</a></td>
</tr>
<tr>
<td>Python 3.7.4 or higher version</td>
<td>Python Software Foundation</td>
<td><a href="https://www.python.org">https://www.python.org</a></td>
</tr>
<tr>
<td>SciPy v1.3.1 or higher version</td>
<td><a href="#bib2">Virtanen et al. (2020)</a></td>
<td><a href="https://www.scipy.org">https://www.scipy.org</a></td>
</tr>
</tbody>
</table>
</section>
<section>
<h2 id="step-by-step-method-details">Step-by-step method details</h2>
<h3 id="sec2.1">BS in general cases</h3>
<div class="timing">
<span class="timing-title">Timing:</span> 1 h for step 1 and 1 h for step 2</div>
<p>In this section, we will describe how to apply the BS to a general system of ODEs where the downstream profile is given.</p>
<ol>
<li>Formulate the dynamics as a set of coupled ODEs.
<ol type="a">
<li>For a dynamical system with <i>n</i> variables <math> <mrow> <mrow> <mo>[</mo> <mrow> <msub> <mi>y</mi> <mn>1</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <msub> <mi>y</mi> <mn>2</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mo>⋯</mo> <mo>,</mo> <msub> <mi>y</mi> <mi>n</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>]</mo> </mrow> <mo>≡</mo> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math> and <i>m</i> parameters <math> <mrow> <mrow> <mo>[</mo> <mrow> <msub> <mi>p</mi> <mn>1</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <msub> <mi>p</mi> <mn>2</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mo>⋯</mo> <mo>,</mo> <msub> <mi>p</mi> <mi>m</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>]</mo> </mrow> <mo>≡</mo> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math> that can be described by a set of coupled ODEs, we divide the rate processes into two parts, i.e.,
<p id="fd1" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 1)</mtext></mtd> <mtd> <mrow> <mfrac> <mrow> <mi>d</mi> <msub> <mi>y</mi> <mi>i</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mo>=</mo> <msub> <mi>F</mi> <mi>i</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>]</mo> </mrow> <mo>+</mo> <msub> <mi>G</mi> <mi>i</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mi>t</mi> </mrow> <mo>]</mo> </mrow> <mo>,</mo> <mi>i</mi> <mo>=</mo> <mn>1,2</mn> <mo>,</mo> <mo>⋯</mo> <mo>,</mo> <mi>n</mi> <mo>,</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
where <math> <mrow> <msub> <mi>F</mi> <mi>i</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>]</mo> </mrow> </mrow> </math>describes the intermediate or interconversion processes of components satisfying <math> <mrow> <munderover> <mrow> <mo>∑</mo> </mrow> <mrow> <mi>i</mi> <mo>=</mo> <mn>1</mn> </mrow> <mi>n</mi> </munderover> <msub> <mi>F</mi> <mi>i</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>]</mo> </mrow> <mo>=</mo> <mn>0</mn> </mrow> </math>, and <math> <mrow> <msub> <mi>G</mi> <mi>i</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mi>t</mi> </mrow> <mo>]</mo> </mrow> </mrow> </math> describes the source/sink-coupled, nonconservative events responsible for the changes in the total pool of <i>y</i><sub><i>i</i></sub>(<i>t</i>) (<i>i</i>=1,2,⋯,<i>n</i>).</li>
<li>Summing up the left- and right-hand sides of <a href="#fd1">Equation 1</a> over <i>i</i>, all the terms responsible for intermediate processes cancel out, leaving only the source/sink-coupled terms:
<p class="math-ml"><math> <mrow> <mfrac> <mi>d</mi> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <munderover> <mrow> <mo>∑</mo> </mrow> <mrow> <mi>i</mi> <mo>=</mo> <mn>1</mn> </mrow> <mi>n</mi> </munderover> <msub> <mi>y</mi> <mi>i</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>=</mo> <munderover> <mrow> <mo>∑</mo> </mrow> <mrow> <mi>i</mi> <mo>=</mo> <mn>1</mn> </mrow> <mi>n</mi> </munderover> <msub> <mi>G</mi> <mi>i</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mi>t</mi> </mrow> <mo>]</mo> </mrow> <mo>.</mo> </mrow> </math></p>
</li>
<li>Take extra care of any fundamental conditions of the variables and terms in the model. For example, if the variables represent molecular concentrations, they should be nonnegative, i.e., <i>y</i><sub><i>i</i></sub>(<i>t</i>)≥0 for <i>i</i>=1,2,⋯,<i>n</i>. Likewise, a nonnegative net influx of component <i>y</i><sub><i>j</i></sub>(<i>t</i>) from an external source indicates <math> <mrow> <msub> <mi>G</mi> <mi>j</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mi>t</mi> </mrow> <mo>]</mo> </mrow> <mo>≥</mo> <mn>0</mn> </mrow> </math>.</li>
</ol>
</li>
</ol>
<ol start="2">
<li>Transform the ODEs to utilize the accessible information on relatively downstream variables in the ODE model.
<ol type="a">
<li>Introduce an observable time-course variable <i>Y</i>(<i>t</i>) as <math> <mrow> <mi>Y</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>≡</mo> <munder> <mrow> <mo>∑</mo> </mrow> <mrow> <mi>i</mi> <mo>∈</mo> <mi>A</mi> </mrow> </munder> <msub> <mi>y</mi> <mi>i</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math> where <i>A</i> is the set of components whose sum is of an experimentally available quantity or of theoretical interest.</li>
<li>For a particular component <i>j</i> selected among the elements of <i>A</i>, we rewrite <i>y</i><sub><i>j</i></sub>(<i>t</i>) as
<p id="fd2" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 2)</mtext></mtd> <mtd> <mrow> <msub> <mi>y</mi> <mi>j</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>=</mo> <mi>Y</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <munder> <mo>∑</mo> <mrow> <mi>i</mi> <mo>∈</mo> <mi>A</mi> <mo>\</mo> <mrow> <mo>{</mo> <mi>j</mi> <mo>}</mo> </mrow> </mrow> </munder> <mrow> <msub> <mi>y</mi> <mi>i</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>.</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
Then, we define <math> <mrow> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math> as an alternative form of <math> <mrow> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math> where <i>y</i><sub><i>j</i></sub>(<i>t</i>) is replaced by the right-hand side of <a href="#fd2">Equation 2</a> and rewrite <a href="#fd1">Equation 1</a> for <math> <mrow> <mi>i</mi> <mo>≠</mo> <mi>j</mi> </mrow> </math>:
<p id="fd3" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 3)</mtext></mtd> <mtd> <mrow> <mfrac> <mrow> <mi>d</mi> <msub> <mi>y</mi> <mi>i</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mo>=</mo> <msub> <mi>F</mi> <mi>i</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>]</mo> </mrow> <mo>+</mo> <msub> <mi>G</mi> <mi>i</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mi>t</mi> </mrow> <mo>]</mo> </mrow> <mo>,</mo> <mi>i</mi> <mo>≠</mo> <mi>j</mi> <mo>.</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
</li>
<li>Combining <a href="#fd2">Equations 2</a> and <a href="#fd3">3</a> for <i>i</i>=<i>j</i>, we obtain
<p id="fd4" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 4)</mtext></mtd> <mtd> <mrow> <msub> <mi>G</mi> <mi>j</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mi>t</mi> </mrow> <mo>]</mo> </mrow> <mo>=</mo> <mfrac> <mrow> <mi>d</mi> <mi>Y</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mo>−</mo> <munder> <mo>∑</mo> <mrow> <mi>k</mi> <mo>∈</mo> <mi>A</mi> <mo>\</mo> <mrow> <mo>{</mo> <mi>j</mi> <mo>}</mo> </mrow> </mrow> </munder> <mrow> <mfrac> <mrow> <mi>d</mi> <msub> <mi>y</mi> <mi>k</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mo>−</mo> <msub> <mi>F</mi> <mi>j</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>]</mo> </mrow> <mo>.</mo> </mrow> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
The conventional forward simulation numerically solves <a href="#fd1">Equation 1</a> to obtain <math> <mrow> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math>, given the values of <math> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math> and <math> <mrow> <msub> <mi>G</mi> <mi>i</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mi>t</mi> </mrow> <mo>]</mo> </mrow> </mrow> </math> and the initial condition of <math> <mrow> <mover> <mi>y</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math>. On the other hand, our BS numerically solves <a href="#fd3">Equations 3</a> and <a href="#fd4">4</a> to obtain <math> <mrow> <msub> <mi>G</mi> <mi>j</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mi>t</mi> </mrow> <mo>]</mo> </mrow> </mrow> </math> and <math> <mrow> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math>, given the values of <math> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math>, <i>Y</i>(<i>t</i>), and <math> <mrow> <msub> <mi>G</mi> <mi>i</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mi>t</mi> </mrow> <mo>]</mo> </mrow> </mrow> </math> (<math> <mrow> <mi>i</mi> <mo>≠</mo> <mi>j</mi> </mrow> </math>) and the initial condition of <math> <mrow> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math>. In other words, using a downstream observable <i>Y</i>(<i>t</i>), BS traces back the upstream processes such as <math> <mrow> <msub> <mi>G</mi> <mi>j</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mi>t</mi> </mrow> <mo>]</mo> </mrow> </mrow> </math>.</li>
<li>If the computed <math> <mrow> <msub> <mi>G</mi> <mi>j</mi> </msub> <mrow> <mo>[</mo> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>;</mo> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> <mi>t</mi> </mrow> <mo>]</mo> </mrow> </mrow> </math> or <math> <mrow> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math> does not satisfy the fundamental conditions imposed by a modeler, they are treated as infeasible solutions. For example, if <i>y</i><sub><i>i</i></sub>(<i>t</i>) in <math> <mrow> <msub> <mover> <mi>y</mi> <mo>→</mo> </mover> <mi>Y</mi> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math>represents the concentration of each molecular species <i>i</i>, <i>y</i><sub><i>i</i></sub>(<i>t</i>) should be non-negative for all <i>i</i>’s. Depending on cases, the infeasible solutions may indicate the incompatibility of a simulated parameter set <math> <mrow> <mover> <mi>p</mi> <mo>→</mo> </mover> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </math> to an observed profile of <i>Y</i>(<i>t</i>).</li>
</ol>
</li>
</ol>
<h3 id="sec2.2">Application of BS to a circadian protein degradation model</h3>
<div class="timing">
<span class="timing-title">Timing:</span> 1 h for step 3, 1 h for step 4, 1 h for step 5, and 2 h for step 6</div>
<p>In this section, we will describe how to apply the BS to a circadian protein degradation model in <a href="#bib1">Lim et al. (2021)</a>. Step 3 and 4 show how to modify the set of coupled ODEs of a circadian protein degradation model for the BS. How to write the codes for the BS and how to examine the ODE system are included in step 5 and 6, respectively.</p>
<ol start="3">
<li>Formulate the dynamics as a set of coupled ODEs.
<ol type="a">
<li>In our circadian protein degradation model in <a href="#bib1">Lim et al. (2021)</a>, the time derivatives of the concentrations of several forms of a circadian protein are described as follows (<a href="#fig1">Figure 1</a>):
<p id="fd5" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 5)</mtext></mtd> <mtd> <mrow> <mfrac> <mrow> <mi>d</mi> <msub> <mi>x</mi> <mn>0</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mo>=</mo> <mi>g</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <msub> <mi>a</mi> <mn>0</mn> </msub> <mi>u</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <msub> <mi>x</mi> <mn>0</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>a</mi> <mn>1</mn> </msub> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mn>0</mn> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <mi>s</mi> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
<p id="fd6" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 6)</mtext></mtd> <mtd> <mrow> <mfrac> <mrow> <mi>d</mi> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mn>0</mn> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mo>=</mo> <msub> <mi>a</mi> <mn>0</mn> </msub> <mi>u</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <msub> <mi>x</mi> <mn>0</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <msub> <mi>a</mi> <mn>1</mn> </msub> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mn>0</mn> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <mi>q</mi> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mn>0</mn> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
<p id="fd7" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 7)</mtext></mtd> <mtd> <mrow> <mfrac> <mrow> <mi>d</mi> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mo>=</mo> <mi>q</mi> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mn>0</mn> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>a</mi> <mn>0</mn> </msub> <mi>u</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <msub> <mi>a</mi> <mn>2</mn> </msub> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <msub> <mi>r</mi> <mn>0</mn> </msub> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
<p id="fd8" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 8)</mtext></mtd> <mtd> <mrow> <mtable> <mtr> <mtd> <mrow> <mspace></mspace> <mfrac> <mrow> <mi>d</mi> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mo>=</mo> <msub> <mi>a</mi> <mn>2</mn> </msub> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>b</mi> <mn>1</mn> </msub> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <msub> <mi>b</mi> <mn>0</mn> </msub> <mi>v</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mspace></mspace> <mo>−</mo> <msub> <mi>a</mi> <mn>0</mn> </msub> <mi>u</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <msub> <mi>r</mi> <mn>0</mn> </msub> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> </mrow> </mtd> </mtr> </mtable> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
<p id="fd9" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 9)</mtext></mtd> <mtd> <mrow> <mfrac> <mrow> <mi>d</mi> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mo>=</mo> <msub> <mi>b</mi> <mn>0</mn> </msub> <mi>v</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <msub> <mi>b</mi> <mn>1</mn> </msub> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <mi>s</mi> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <msub> <mi>r</mi> <mn>0</mn> </msub> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
with the following two quantities:
<p id="fd10" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 10)</mtext></mtd> <mtd> <mrow> <mover> <mi>u</mi> <mo>¯</mo> </mover> <mo>≡</mo> <mi>u</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mn>0</mn> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
<p id="fd11" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 11)</mtext></mtd> <mtd> <mrow> <mover> <mi>v</mi> <mo>¯</mo> </mover> <mo>≡</mo> <mi>v</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>.</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
The variables and rate parameters in <a href="#fd5">Equations 5</a>, <a href="#fd6">6</a>, <a href="#fd7">7</a>, <a href="#fd8">8</a>, <a href="#fd9">9</a>, <a href="#fd10">10</a>, and <a href="#fd11">11</a> are defined in <a href="#tbl1">Tables 1</a> and <a href="#tbl2">2</a>.</li>
<li>As a sanity check, sum up <a href="#fd5">Equations 5</a>, <a href="#fd6">6</a>, <a href="#fd7">7</a>, <a href="#fd8">8</a>, and <a href="#fd9">9</a> and obtain the time derivative of the total protein concentration:
<p id="fd12" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 12)</mtext></mtd> <mtd> <mrow> <mtable> <mtr> <mtd> <mrow> <mfrac> <mi>d</mi> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mrow> <mo>[</mo> <mrow> <msub> <mi>x</mi> <mn>0</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mn>0</mn> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>]</mo> </mrow> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mspace></mspace> <mo>=</mo> <mi>g</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <msub> <mi>r</mi> <mn>0</mn> </msub> <mrow> <mo>[</mo> <mrow> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>]</mo> </mrow> <mo>.</mo> </mrow> </mtd> </mtr> </mtable> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
This result makes sense because <i>g</i>(<i>t</i>) represents the ultimate source of protein production and the variables with a common coefficient <i>r</i><sub>0</sub> are the concentrations of ubiquitinated proteins destined for degradation.</li>
<li>Let <i>x</i>(<i>t</i>) denote the total protein concentration:
<p id="fd13" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 13)</mtext></mtd> <mtd> <mrow> <mi>x</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>≡</mo> <msub> <mi>x</mi> <mn>0</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mn>0</mn> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>.</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
<a href="#fd12">Equation 12</a> is rewritten as
<p id="fd14" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 14)</mtext></mtd> <mtd> <mrow> <mfrac> <mrow> <mi>d</mi> <mi>x</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mo>=</mo> <mi>g</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <mi>r</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mi>x</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
where <i>r</i>(<i>t</i>) is the protein degradation rate given by
<p id="fd15" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 15)</mtext></mtd> <mtd> <mrow> <mi>r</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>≡</mo> <msub> <mi>r</mi> <mn>0</mn> </msub> <mrow> <mo>[</mo> <mrow> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>]</mo> </mrow> <mo>/</mo> <mi>x</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>.</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
</li>
<li>Be cautious about the implicit physical or biological constraints on the variables and parameters. In the example of our model, all the molecular concentrations should be nonnegative. That is,
<p id="fd16" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 16)</mtext></mtd> <mtd> <mrow> <mtable> <mtr> <mtd> <mrow> <msub> <mi>x</mi> <mn>0</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>≥</mo> <mn>0</mn> <mo>,</mo> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mn>0</mn> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>≥</mo> <mn>0</mn> <mo>,</mo> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>≥</mo> <mn>0</mn> <mo>,</mo> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>≥</mo> <mn>0</mn> <mo>,</mo> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>≥</mo> <mn>0</mn> <mo>,</mo> </mrow> </mtd> </mtr> <mtr> <mtd> <mrow> <mi>u</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>≥</mo> <mn>0</mn> <mo>,</mo> <mi>v</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>≥</mo> <mn>0</mn> <mo>.</mo> </mrow> </mtd> </mtr> </mtable> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
Additionally, because the protein synthesis rate cannot be negative, the following inequality should be satisfied:
<p id="fd17" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 17)</mtext></mtd> <mtd> <mrow> <mi>g</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>≥</mo> <mn>0</mn> <mo>.</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
</li>
</ol>
</li>
</ol>
<ol start="4">
<li>Transform the ODEs to utilize the experimentally available information on relatively downstream variables in the ODE model.
<ol type="a">
<li>In the example of our model, the experimentally available data were the total concentration <i>x</i>(<i>t</i>) of a protein rather than those of the individual sub-forms of the protein or the protein synthesis rate at the upstream level. Although the experimental data usually represent the relative, but not absolute, molecular concentrations, the use of the relative concentration for <i>x</i>(<i>t</i>) in our model only changes the “unit” of concentrations without loss of generality. On the other hand, if multiple datasets of their own relative levels are incorporated into the model variables of the same dimensional quantities, the appropriate proportionality coefficients or conversion factors should be introduced for the sake of a unified scale.</li>
<li>Plug the following relation (from <a href="#fd13">Equation 13</a>) in <a href="#fd5">Equations 5</a> and <a href="#fd6">6</a>:
<p id="fd18" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 18)</mtext></mtd> <mtd> <mrow> <msub> <mi>x</mi> <mn>0</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>=</mo> <mi>x</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <mrow> <mo>[</mo> <mrow> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mn>0</mn> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mn>0</mn> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>+</mo> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mo>]</mo> </mrow> <mo>.</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
</li>
<li>
<i>g</i>(<i>t</i>) in <a href="#fd5">Equation 5</a> is rewritten as
<p id="fd19" class="math-ml"><math> <mtable> <mlabeledtr> <mtd><mtext>(Equation 19)</mtext></mtd> <mtd> <mrow> <mi>g</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>=</mo> <mfrac> <mrow> <mi>d</mi> <msub> <mi>x</mi> <mn>0</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> </mrow> <mrow> <mi>d</mi> <mi>t</mi> </mrow> </mfrac> <mo>+</mo> <msub> <mi>a</mi> <mn>0</mn> </msub> <mi>u</mi> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <msub> <mi>x</mi> <mn>0</mn> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <msub> <mi>a</mi> <mn>1</mn> </msub> <msub> <mi>x</mi> <mrow> <mi>E</mi> <mo>,</mo> <mn>0</mn> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>−</mo> <mi>s</mi> <msub> <mi>x</mi> <mrow> <mi>H</mi> <mo>,</mo> <mi>u</mi> <mi>b</mi> </mrow> </msub> <mrow> <mo>(</mo> <mi>t</mi> <mo>)</mo> </mrow> <mo>,</mo> </mrow> </mtd> </mlabeledtr> </mtable> </math></p>
where <i>x</i><sub>0</sub>(<i>t</i>) is replaced by the right-hand side in <a href="#fd18">Equation 18</a>. We are now ready for the BS of our model, using <a href="#fd6">Equations 6</a>, <a href="#fd7">7</a>, <a href="#fd8">8</a>, <a href="#fd9">9</a>, <a href="#fd10">10</a>, <a href="#fd11">11</a>, <a href="#fd18">18</a>, and <a href="#fd19">19</a>. Note that, in usual practice, <i>x</i>(<i>t</i>) and other variables are simulated using the profile of <i>g</i>(<i>t</i>); in our BS, <i>g</i>(<i>t</i>) and other variables are reversely simulated using the profile of <i>x</i>(<i>t</i>), through <a href="#fd6">Equations 6</a>, <a href="#fd7">7</a>, <a href="#fd8">8</a>, <a href="#fd9">9</a>, <a href="#fd10">10</a>, <a href="#fd11">11</a>, <a href="#fd18">18</a>, and <a href="#fd19">19</a>.</li>
</ol>
</li>
</ol>
<ol start="5">
<li>Write the codes for simulation.
<ol type="a">
<li>Import Python modules (scipy).</li>
<li>Read the time-course data of the total protein abundance. If the data do not span more than a single circadian period, expand them by the repetition of the data points to multiple circadian periods. This step is necessary if one wants to simulate the long-term asymptotic behavior of our circadian model, as will be explained later.</li>
<li>Interpolate the data points of the total protein abundance. This step is necessary for the construction of a continuous trajectory of <i>x</i>(<i>t</i>) for our model simulation, given the discrete nature of time points with available data.
<ol type="i">
<li>Import interp1d module from scipy.interpolate.</li>
<li>Implement a cubic interpolation by setting the option “kind = ‘cubic’”. The result is an interpolated curve of <i>x</i>(<i>t</i>), as exemplified by <a href="#fig2">Figure 2</a>A.
<figure id="fig1"><img src="https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1175-Fig1.jpg" alt="Fig1.jpg">
<figcaption>
<div class="figcaption-title">Figure 1. The protein degradation model</div>
<p>There are a total of five types of substrate proteins, defined in <a href="#tbl2">Table 2</a>. Substrate proteins (rounded rectangles, sky blue) are synthesized from mRNA molecules (blue line, top left) in the ribosome (brown, top left) and ubiquitinated by E3 ubiquitin ligases (orange ovals) with ubiquitins (yellow circles). The ubiquitinated proteins are degraded (gray ovals) or deubiquitinated by deubiquitinating enzymes (light green hexagon). The total protein concentration is represented by <i>x</i>(<i>t</i>) with symbol <i>Σ</i> at the center.</p>
</figcaption>
</figure>
<figure id="fig2"><img src="https://prod-shared-star-protocols.s3.amazonaws.com/protocols/1175-Fig2.jpg" alt="Fig2.jpg">
<figcaption>
<div class="figcaption-title">Figure 2. Examining the behaviors of the protein degradation model</div>
<p>(A) The example, total protein concentration profile used for BS.</p>
<p>(B and C) Simulated <i>g</i>(<i>t</i>) (B) and <i>r</i>(<i>t</i>) (C) with different initial conditions. Given the protein profile in (A), the simulated <i>g</i>(<i>t</i>) or <i>r</i>(<i>t</i>) rapidly converges at the same trajectory, regardless of its initial conditions.</p>
<p>(D) The example output of the code “check_physical_constraints.py” to check the feasibility of the BS solution. If the solution does not satisfy its fundamental conditions, the code returns the message in (D).</p>
<p>(E and F) Simulated profiles of protein sub-states: <i>x</i><sub>0</sub>(<i>t</i>) (purple), <i>x</i><sub><i>E</i>,0</sub>(<i>t</i>) (yellow), <i>x</i><sub><i>E</i>,<i>ub</i></sub>(<i>t</i>) (gray), <i>x</i><sub>0,<i>ub</i></sub>(<i>t</i>) (blue), and <i>x</i><sub><i>H</i>,<i>ub</i></sub>(<i>t</i>) (red). When <math> <mrow> <mover> <mi>v</mi> <mo>¯</mo> </mover> </mrow> </math> is set to zero, <i>x</i><sub><i>H</i>,<i>ub</i></sub>(<i>t</i>) becomes zero (E). When <i>a</i><sub>0</sub>, <i>b</i><sub>0</sub>, <math> <mrow> <mover> <mi>u</mi> <mo>¯</mo> </mover> </mrow> </math>, and <math> <mrow> <mover> <mi>v</mi> <mo>¯</mo> </mover> </mrow> </math> are set as relatively high and <i>a</i><sub>2</sub> and <i>b</i><sub>1</sub> are set as relatively low, <i>x</i><sub>0,<i>ub</i></sub>(<i>t</i>) becomes almost zero (F).</p>
</figcaption>
</figure>
<table id="tbl1">
<caption>Table 1. Parameters in the protein degradation model</caption>
<thead>
<tr>
<th>Parameter</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<i>a</i><sub>0</sub>
</td>
<td>Rate of ubiquitin ligase binding to a substrate protein.</td>
</tr>
<tr>
<td>
<i>a</i><sub>1</sub>
</td>
<td>Dissociation rate of a ubiquitin ligase and a not-ubiquitinated protein.</td>
</tr>
<tr>
<td>
<i>a</i><sub>2</sub>
</td>
<td>Dissociation rate of a ubiquitin ligase and a ubiquitinated protein.</td>
</tr>
<tr>
<td>
<i>b</i><sub>0</sub>
</td>
<td>Rate of deubiquitinating enzyme binding to a ubiquitinated protein.</td>
</tr>
<tr>
<td>
<i>b</i><sub>1</sub>
</td>
<td>Dissociation rate of a deubiquitinating enzyme and a ubiquitinated protein.</td>
</tr>
<tr>
<td><i>q</i></td>
<td>Ubiquitination rate of a protein binding to a ubiquitin ligase.</td>
</tr>
<tr>
<td><i>s</i></td>
<td>Deubiquitination rate of a protein binding to a deubiquitinating enzyme, lumped with its subsequent dissociation from the deubiquitinating enzyme.</td>
</tr>
<tr>
<td>
<i>r</i><sub>0</sub>
</td>
<td>Degradation rate of a ubiquitinated protein.</td>
</tr>
<tr>
<td><math> <mrow> <mover> <mi>u</mi> <mo>¯</mo> </mover> </mrow> </math></td>
<td>Total ubiquitin ligase concentration.</td>
</tr>
<tr>
<td><math> <mrow> <mover> <mi>v</mi> <mo>¯</mo> </mover> </mrow> </math></td>
<td>Total deubiquitinating enzyme concentration.</td>
</tr>
</tbody>
</table>
<table id="tbl2">
<caption>Table 2. Variables in the protein degradation model</caption>
<thead>
<tr>
<th>Variable</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><i>t</i></td>
<td>Time.</td>
</tr>
<tr>
<td>
<i>x</i><sub>0</sub>(<i>t</i>)</td>
<td>Concentration of a free protein without ubiquitination.</td>
</tr>
<tr>
<td>
<i>x</i><sub><i>E</i>,0</sub>(<i>t</i>)</td>
<td>Concentration of a not-ubiquitinated protein that is binding to a ubiquitin ligase.</td>
</tr>
<tr>
<td>
<i>x</i><sub><i>E</i>,<i>ub</i></sub>(<i>t</i>)</td>
<td>Concentration of a ubiquitinated protein that is binding to a ubiquitin ligase.</td>
</tr>
<tr>
<td>
<i>x</i><sub>0,<i>ub</i></sub>(<i>t</i>)</td>
<td>Concentration of a ubiquitinated protein that is not binding to a ubiquitin ligase.</td>
</tr>
<tr>
<td>
<i>x</i><sub><i>H</i>,<i>ub</i></sub>(<i>t</i>)</td>
<td>Concentration of a ubiquitinated protein that is binding to a deubiquitinating enzyme.</td>
</tr>
<tr>
<td>
<i>g</i>(<i>t</i>)</td>
<td>Protein synthesis rate.</td>
</tr>
<tr>
<td>
<i>u</i>(<i>t</i>)</td>
<td>Concentration of a free ubiquitin ligase.</td>
</tr>
<tr>
<td>
<i>v</i>(<i>t</i>)</td>
<td>Concentration of a free deubiquitinating enzyme.</td>
</tr>
</tbody>
</table>
</li>
<li>Build a Python function that uses time, an array of concentrations, an array of kinetic parameters, an interpolated curve of <i>x</i>(<i>t</i>) as input, and returns an array of the model variables and their time derivatives in <a href="#fd6">Equations 6</a>, <a href="#fd7">7</a>, <a href="#fd8">8</a>, <a href="#fd9">9</a>, <a href="#fd10">10</a>, <a href="#fd11">11</a>, <a href="#fd18">18</a>, and <a href="#fd19">19</a> as output.</li>
</ol>
</li>
<li>Solve the ODEs with scipy.solve_ivp module.
<ol type="i">
<li>Import solve_ivp module from scipy.integrate.</li>
<li>Set the parameters “fun”, “t_span”, “t_eval”, and “y0”. Here, “fun” is a Python function of which input is ‘t’ (time) and ‘y’ (an array of the values of variables) and output is an array of the time derivatives of the variables. “t_span” is a tuple containing two time points that indicate the beginning and end of the simulation. “t_eval” is an array of time points at which to store the computed solutions. “y0” is an array of the initial states of the variables.</li>
<li>When solving the system of ODEs numerically, we must take the following into consideration:(1) Selection of time step: When selecting the maximum time step for the simulation, it should be much smaller than the time scale of dynamics. For the circadian proteins, the time scale is ∼24 h. Therefore, it is safe to select the maximum time step much smaller than an hour. Moreover, checking whether the solution does not noticeably change with smaller time steps will assure the selection of an adequate time step. In the scipy.solve_ivp module, changing the “max_step” option would modify the maximum time step to solve the ODEs.(2) Stiffness of the problem: If the ODEs contain stiff terms, the Runge-Kutta method is not recommended. In this case, “LSODA”, “BDF”, or “Radau” methods are recommended. The method to solve the ODEs can be changed by setting the “method” option in the scipy.solve_ivp module.(3) Numerical error tolerance: When solving the system of ODEs, estimated errors can be controlled. “atol” and “rtol” options in the scipy.solve_ivp module can be used to control absolute and relative errors respectively.</li>
</ol>
</li>
</ol>
</li>
</ol>
<ol start="6">
<li>Test the behaviors of the ODE model.
<ol type="a">
<li>Check whether the model output is not too sensitive to the initial conditions, given the profile of the observable (e.g., <i>x</i>(<i>t</i>) in our case) and the parameter values. This step is to determine whether the simulation outcome is essentially unique or not, regardless of particular initial conditions. One method is to randomly sample the initial conditions of each variable within a physiologically-relevant range and then check whether the simulation outcomes converge at similar trajectories. In the case of our model, the code in the following command allows the test of this initial condition dependency:
<div class="textbox">
<p><code>&gt; python check_initial_conditions_sensitivity.py</code></p>
</div>
The execution of the code gives the graphs of each variable as the functions of time with different initial conditions. <a href="#fig2">Figures 2</a>B and <a href="#fig2">2</a>C demonstrate that <i>g</i>(<i>t</i>) and <i>r</i>(<i>t</i>) in our model converge well respectively, regardless of their initial conditions when <i>x</i>(<i>t</i>) (<a href="#fig2">Figure 2</a>A) and parameter values are assigned for the simulation.</li>
<li>Determine the minimum simulation length to approach the asymptotic solutions of the ODE model. By running the simulation for a long enough time, i.e., setting the large values for ‘t_span’ and ‘t_eval’ options, check when the ODE solutions exhibit saturated and sustained oscillations in our case. If the simulation does not result in the stable oscillations, try longer simulation lengths. Identify the minimum simulation length to ensure the stable oscillations. The code in the following command allows this test:
<div class="textbox">
<p><code>&gt; python check_long_time.py</code></p>
</div>
Executing the code gives the graphs of each variable over a long time. Through these graphs, one can determine the minimum simulation length.</li>
<li>Check whether the ODE solutions satisfy all the physical and biological constraints and thus can be considered as feasible solutions. Some ODE solutions may not satisfy these constraints, particularly in the case of BS. The reason is that BS does not run in a natural causal direction from upstream to downstream levels, but traces back the upstream states without the prospect of their compatibility with the parameter values. In other words, only the parameter values with the feasible solutions of BS are compatible with the downstream observable, and hence BS can identify those sensible parameter values. In the example of our model, the solutions should satisfy all the constraints in <a href="#fd16">Equations 16</a> and <a href="#fd17">17</a>. The code in the following command allows this feasibility test of the model solutions:
<div class="textbox">
<p><code>&gt; python check_physical_constraints.py</code></p>
</div>
The code verifies whether the constraints in <a href="#fd16">Equations 16</a> and <a href="#fd17">17</a> are satisfied or not (<a href="#fig2">Figure 2</a>D).</li>
<li>Debug the code of the ODE model. By simulating different parameter values, one can check the potential bugs in the code. In the example of our model, if <math> <mrow> <mover> <mi>v</mi> <mo>¯</mo> </mover> </mrow> </math> is set to 0, <i>x</i><sub><i>H</i>,<i>ub</i></sub>(<i>t</i>) should be zero. In <a href="#fd8">Equation 8</a>, if <i>a</i><sub>0</sub><i>u</i>(<i>t</i>) and <i>b</i><sub>0</sub><i>v</i>(<i>t</i>) are much higher than <i>a</i><sub>2</sub> and <i>b</i><sub>1</sub> by setting <i>a</i><sub>0</sub>, <i>b</i><sub>0</sub>, <math> <mrow> <mover> <mi>u</mi> <mo>¯</mo> </mover> </mrow> </math>, and <math> <mrow> <mover> <mi>v</mi> <mo>¯</mo> </mover> </mrow> </math> as relatively high and setting <i>a</i><sub>2</sub> and <i>b</i><sub>1</sub> as relatively low, then <i>x</i><sub>0,<i>ub</i></sub>(<i>t</i>) should become very small (<a href="#fig2">Figures 2</a>E and <a href="#fig2">2</a>F). The code in the following command allows these bug tests:
<div class="textbox">
<p><code>&gt; python check_debugging.py</code></p>
</div>
Executing this code gives the parameter conditions and the graphs of the relevant simulation results.</li>
</ol>
</li>
</ol>
<h3 id="sec2.3">Sampling of parameter values</h3>
<div class="timing">
<span class="timing-title">Timing:</span> 1 h to several days (depending on the size of parameter dimension)</div>
<p>In this section, we will describe how to sample a large number of parameter values with multiple CPU cores. Utilizing parallel computing would save much of the simulation time.</p>
<ol start="7">
<li>Generate multiple parameter values and run the BS with these parameter values.
<ol type="a">
<li>If the number of the parameter values is too large, the Python modules “multiprocessing” and “mpi4py” can save much of the simulation time.
<ol type="i">
<li>How to use “multiprocessing” module: construct the wrapping module that only takes “parameter_sets”. The “parameter_sets” is a list of <i>N</i> parameter sets, and the wrapper is a wrapping module that takes a single parameter set as input. Parallel computing with a number of CPU cores can be implemented using these modules.
<div class="textbox">
<p><code>&gt; import multiprocessing as mp</code></p>
<p><code>&gt; parameter_sets = [parameter_set_1, …, parameter_set_N]</code></p>
<p><code>&gt; pool = mp.Pool(Number_of_CPU_cores)</code></p>
<p><code>&gt; pool.map(wrapper, parameter_sets)</code></p>
</div>
</li>
<li>How to use “mpi4py” module: “mpi4py” module allows the model simulation with each node. An example is shown below.
<div class="textbox">
<p><code>&gt; from mpi4py import MPI</code></p>
<p><code>&gt; comm = MPI.COMM_WORLD</code></p>
<p><code>&gt; num_processor = comm.Get_size()</code></p>
<p><code>&gt; rank = comm.Get_rank()</code></p>
<p><code>&gt; simulation_done_by_one = 0</code></p>
<p><code>&gt; simulation_target_by_one = N</code></p>
<p><code>&gt; while(simulation_done_by_one &lt; simulation_target_by_one):</code></p>
<p><code>&gt;  …</code></p>
<p><code>&gt;  simulation_done_by_one += 1</code></p>
</div>
Here, N is the target number of the simulations in one node.
<div class="note">
<span class="note-title">Note:</span> In both the cases i and ii above, be careful when writing a file. If two different nodes access the same file, this file may not be readable at the end.</div>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</section>
<section>
<h2 id="expected-outcomes">Expected outcomes</h2>
<p>The BS method allows us to identify the valid parameter sets for experimentally available downstream data and to inspect the internal dynamics of the system with the fixed profiles of particular components. The latter would be useful for rigorous mechanistic inspection of a dynamical system. For example, we controlled for the protein profile <i>x</i>(<i>t</i>) in <a href="#bib1">Lim et al. (2021)</a> and found that the degradation rate <i>r</i>(<i>t</i>) tends to be more rhythmic with a lower level of a ubiquitin ligase <math> <mrow> <mover> <mi>u</mi> <mo>¯</mo> </mover> </mrow> </math>. In addition, we identified a definite lower bound of <math> <mrow> <mover> <mi>u</mi> <mo>¯</mo> </mover> </mrow> </math> for the establishment of a given profile of <i>x</i>(<i>t</i>) itself, along with other interesting phenomena. Without the help of the BS, these clear conclusions may not be drawn, because in the conventional simulation with a fixed profile of the protein synthesis rate <i>g</i>(<i>t</i>), the change of <math> <mrow> <mover> <mi>u</mi> <mo>¯</mo> </mover> </mrow> </math> modifies the oscillatory form of <i>x</i>(<i>t</i>) itself and thus does not clearly separate the effect of <math> <mrow> <mover> <mi>u</mi> <mo>¯</mo> </mover> </mrow> </math> from that of the <i>x</i>(<i>t</i>) profile on the generation of rhythmic <i>r</i>(<i>t</i>) (<a href="#bib1">Lim et al., 2021</a>).</p>
</section>
<section>
<h2 id="limitations">Limitations</h2>
<p>Our BS method is based on ODE models, and its applications beyond ODE models are not yet straightforward. In addition, it should be noticed that BS does not aim to infer unknown parameter values; rather, it infers the upstream dynamics with given parameter values, and thereby identifies the parameter values with feasible upstream states, compatible with the downstream observables. If the BS is implemented with randomly-sampled parameters, the large number of parameter sets may need to be sampled as the dimension of the parameter space increases ( <i>d</i><sup><i>N</i></sup> parameter sets, where <i>N</i> is the number of parameters in the model and <i>d</i> is the number of different values sampled for each parameter). Obviously, this massive parameter sampling can be computationally demanding.</p>
</section>
<section>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="sec5.1">Problem 1</h3>
<p>When solving an ODE model with the scipy.solve_ivp module, the computation time may sometimes be very long (step 6 of section “<a href="#sec2.2">application of BS to a circadian protein degradation model</a>”).</p>
<h3 id="sec5.2">Potential solution</h3>
<p>When the interpolated curve of the experimental profile is smooth enough, the option “method = “RK45”” and “method = “LSODA”” will not take much different computational times. However, if the interpolated curve is not smooth enough, “method = “RK45”” will take longer computational time. Therefore, in this case, we recommend the use of “method = “LSODA”” for shorter computational time.</p>
<h3 id="sec5.3">Problem 2</h3>
<p>If the profile of <i>x</i>(<i>t</i>) in our model is too noisy, most BS results will not give the feasible solutions of the upstream states. These noisy patterns are likely to come from very high temporal resolution of the experimental data. For example, the PER2 profile for our BS in <a href="#bib1">Lim et al. (2021)</a> was obtained from the data of <a href="#bib3">Zhou et al. (2015)</a> with 6-min resolution. (step 2.a of section “<a href="#sec2.1">BS in general cases</a>” and step 4.a of section “<a href="#sec2.2">application of BS to a circadian protein degradation model</a>”).</p>
<h3 id="sec5.4">Potential solution</h3>
<p>Time window averaging or other denoising techniques can be applied to the noisy profile. However, be cautious of the possibility that such smoothening may distort the original patterns in the profile.</p>
<h3 id="sec5.5">Problem 3</h3>
<p>The ODE solutions are not sometimes accurate enough (step 5.d.iii and step 6 of section “<a href="#sec2.2">application of BS to a circadian protein degradation model</a>”).</p>
<h3 id="sec5.6">Potential solution</h3>
<p>There is an option in scipy.solve_ivp to control the error-tolerance level in numerical integration of ODEs. By adjusting the options ‘atol’ and ‘rtol’, one can manage the absolute and relative levels of the tolerance to the numerical errors, respectively. However, too small ‘atol’ and ‘rtol’ values can considerably slow down the computation.</p>
<h3 id="sec5.7">Problem 4</h3>
<p>When simulating excessively many parameter sets, it is difficult to manually determine whether ODE solutions have reached their attractors or not within the simulation time (step 7 of section “<a href="#sec2.3">sampling of parameter values</a>”).</p>
<h3 id="sec5.8">Potential solution</h3>
<p>Some parameter sets may take long computation time towards the asymptotic states of the model outcome. In the case of our model, if the peak values of the oscillating variables decrease or increase with more than some fold change in the past two circadian periods, these variables may not be considered to reach the stable oscillatory states at that time.</p>
<h3 id="sec5.9">Problem 5</h3>
<p>When solving the system of ODEs with the scipy.solve_ivp module, the solution includes time points assigned in the “t_eval” argument. However, a continuous time series of the solution might be needed in some cases (step 5.d of section “<a href="#sec2.2">application of BS to a circadian protein degradation model</a>”).</p>
<h3 id="sec5.10">Potential solution</h3>
<p>If an option in the solve_ivp module, “dense_output” is set to “True”, it will return a class instance for the ODE solution at a given time point. However, this option might increase the computation time for the solution especially when the solution involves a long time series. Alternatively, the use of small time steps for the “t_eval” option and the interpolation of the solution over the last one or two time periods only would save the computation time.</p>
</section>
<section>
<h2 id="references">References</h2>
<p id="bib1">Lim, R., Chae, J., Somers, D.E., Ghim, C.-M., and Kim, P.-J. (2021). Cost-effective circadian mechanism: rhythmic degradation of circadian proteins spontaneously emerges without rhythmic post-translational regulation. iScience <i>24</i>, 102726. <a class="external-link" href="http://refhub.elsevier.com/S2666-1667(21)00664-X/sref1">View at publisher</a></p>
<p id="bib2">Virtanen, P., Gommers, R., Oliphant, T.E., Haberland, M., Reddy, T., Cournapeau, D., Burovski, E., Peterson, P., Weckesser, W., Bright, J., et al. (2020). SciPy 1.0: fundamental algorithms for scientific computing in Python. Nat. Methods <i>17</i>, 261-272. <a class="external-link" href="http://refhub.elsevier.com/S2666-1667(21)00664-X/sref2">View at publisher</a></p>
<p id="bib3">Zhou, M., Kim, J.K., Eng, G.W., Forger, D.B., and Virshup, D.M. (2015). A Period2 phosphoswitch regulates and temperature compensates circadian period. Mol. Cell <i>60</i>, 77-88. <a class="external-link" href="http://refhub.elsevier.com/S2666-1667(21)00664-X/sref3">View at publisher</a></p>
</section>
<section>
<h2 id="article-info">Article info</h2>
<h3>Resource availability</h3>
<h4>Lead contact</h4>
<p>Further information and requests for resources and reagents should be directed to and will be fulfilled by the lead contact, Pan-Jun Kim (<a href="mailto:panjunkim@hkbu.edu.hk">panjunkim@hkbu.edu.hk</a>).</p>
<h4>Materials availability</h4>
<p>This study did not generate any unique reagents.</p>
<h4>Data and code availability</h4>
<p>This study did not generate new experimental data.</p>
<p>Source codes for our model simulation have been deposited to public repository GitHub, and the link is provided in the <a href="#key-resources-table">key resources table</a>.</p>
<h3>Acknowledgments</h3>
<p>This work was supported by <a href="https://doi.org/10.13039/501100001747">Hong Kong Baptist University</a>, Research Committee, Start-up Grant for New Academics (R.L. and P.-J.K.) and the <a href="https://doi.org/10.13039/501100003725">National Research Foundation of Korea</a> Grants NRF-2020R1A4A1019140 and NRF-2020R1F1A1075942 funded by the <a href="https://doi.org/10.13039/501100014188">Ministry of Science and ICT</a> (J.C. and C.-M.G). This work was partially conducted with the resources of the High Performance Cluster Computing Centre, Hong Kong Baptist University, which receives funding from Research Grant Council, University Grant Committee of the HKSAR and Hong Kong Baptist University. We also acknowledge the support of the UNIST Supercomputing Center for the computing resources.</p>
<h3>Author contributions</h3>
<p>C.-M.G. and P.-J.K. supervised the research. J.C., R.L., C.-M.G., and P.-J.K. designed the research. J.C. and R.L. performed the research. J.C., R.L., C.-M.G., and P.-J.K. wrote the manuscript.</p>
<h3>Declaration of interests</h3>
<p>The authors declare no competing interests.</p>
</section>
</article>